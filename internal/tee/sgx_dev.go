//go:build dev

package tee

import (
	"crypto/ecdsa"
	"encoding/hex"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/crypto"
	"github.com/taikoxyz/gaiko/internal/flags"
)

var (
	devRawQuote   = "03000200000000000a000f00939a7233f79c4ca9940a0db3957f0607cd47b96821154ee5a17ea5d0cf3c0739000000000e0e100fffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000050000000000000007000000000000007cb1afb4d3505b9028d9aec761be3541a703b072eee5800be2f98e844f1cebcc000000000000000000000000000000000000000000000000000000000000000097f37974b1a9a1f64b2e50b820a79721078df06e1268a303bd8427100d587f440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000096216849c49358b10257cb55b28ea603c874b05e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ca100000a64f884b4d8fe41d152893f31b7734d3dbcf5c936120875d8b09b6a11ce3820352534885ddd16a8e48cd7d9105ebb1d89841b3531f0010e797099f2c5878dfe99bd60608d2be61f8999a86b8ede973adf92560e587c3813ecc9064ca2bde764128180210a87439affe2d846fccaa9155e02ec14b6bfc44daca70bda427b136540e0e100fffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000001500000000000000e70000000000000096b347a64e5a045e27369c26e6dcda51fd7c850e9b3a3a79e718f43261dee1e400000000000000000000000000000000000000000000000000000000000000008c4f5775d796503e96137f77c68a829a0056ac8ded70140b081b094490c57bff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003fe86d973e773b711b443a17442e4fa6b10bdf8a75c38b1800887c9941e241600000000000000000000000000000000000000000000000000000000000000000352cc26144d56a19e1c05555421150f0015882b6d62771f164782f1c84329696f1ccb316fb81a7681693a00c9de4e40fae6f9e613eb24e49f7ec2e46aa14cb7c2000000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f0500620e00002d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d494945386a4343424a6967417749424167495543476e4e44657835517361592b6d4a54693135735748323933625577436759494b6f5a497a6a3045417749770a634445694d434147413155454177775a535735305a577767553064594946424453794251624746305a6d397962534244515445614d42674741315545436777520a535735305a577767513239796347397959585270623234784644415342674e564241634d43314e68626e526849454e7359584a684d51737743515944565151490a44414a445154454c4d416b474131554542684d4356564d774868634e4d6a55774d7a41334d4467784d7a55305768634e4d7a49774d7a41334d4467784d7a55300a576a42774d534977494159445651514444426c4a626e526c624342545231676755454e4c49454e6c636e52705a6d6c6a5958526c4d526f77474159445651514b0a4442464a626e526c6243424462334a7762334a6864476c76626a45554d424947413155454277774c553246756447456751327868636d4578437a414a42674e560a4241674d416b4e424d517377435159445651514745774a56557a425a4d424d4742797147534d34394167454743437147534d34394177454841304941424555340a443741334371733133787563736475784171335a57514e7062467875566f62346b4533746748346b757647374f2b3166644846453155547567776258757355440a41306c346d61636e792b644c39392f6256756d6a67674d4f4d494944436a416642674e5648534d4547444157674253566231334e765276683655424a796454300a4d383442567776655644427242674e56485238455a4442694d47436758714263686c706f64485277637a6f764c32467761533530636e567a6447566b633256790a646d6c6a5a584d75615735305a577775593239744c334e6e6543396a5a584a3061575a7059324630615739754c3359304c33426a61324e796244396a595431770a624746305a6d397962535a6c626d4e765a476c755a7a316b5a584977485159445652304f42425945464a65587a554a39352b2f664847414f734776323431564e0a796649754d41344741315564447745422f775145417749477744414d42674e5648524d4241663845416a41414d4949434f77594a4b6f5a496876684e415130420a424949434c444343416967774867594b4b6f5a496876684e415130424151515132674475422b4670667a6779444f794643556a346e7a434341575547436971470a534962345451454e41514977676746564d42414743797147534962345451454e415149424167454f4d42414743797147534962345451454e415149434167454f0a4d42414743797147534962345451454e41514944416745444d42414743797147534962345451454e41514945416745444d42454743797147534962345451454e0a41514946416749412f7a415242677371686b69472b4530424451454342674943415038774541594c4b6f5a496876684e4151304241676343415141774541594c0a4b6f5a496876684e4151304241676743415141774541594c4b6f5a496876684e4151304241676b43415141774541594c4b6f5a496876684e4151304241676f430a415141774541594c4b6f5a496876684e4151304241677343415141774541594c4b6f5a496876684e4151304241677743415141774541594c4b6f5a496876684e0a4151304241673043415141774541594c4b6f5a496876684e4151304241673443415141774541594c4b6f5a496876684e4151304241673843415141774541594c0a4b6f5a496876684e4151304241684143415141774541594c4b6f5a496876684e4151304241684543415130774877594c4b6f5a496876684e41513042416849450a4541344f4177502f2f7741414141414141414141414141774541594b4b6f5a496876684e4151304241775143414141774641594b4b6f5a496876684e415130420a4241514741474271414141414d41384743697147534962345451454e4151554b415145774867594b4b6f5a496876684e41513042426751514e6d4a47464657610a4159496134476b75344957766744424542676f71686b69472b453042445145484d4459774541594c4b6f5a496876684e4151304242774542416638774541594c0a4b6f5a496876684e4151304242774942416638774541594c4b6f5a496876684e4151304242774d4241663877436759494b6f5a497a6a304541774944534141770a525149674d6e75784d6f53364a79394874786a47654b3278464f6d61394731434c75424a4b616b79486770374c4d7743495144774b6773674e303438577370550a6551686a396e6b392f4f716f54597648486f64557576686d7746667241773d3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949436c6a4343416a32674177494241674956414a567658633239472b487051456e4a3150517a7a674658433935554d416f4743437147534d343942414d430a4d476778476a415942674e5642414d4d45556c756447567349464e48574342536232393049454e424d526f77474159445651514b4442464a626e526c624342440a62334a7762334a6864476c76626a45554d424947413155454277774c553246756447456751327868636d4578437a414a42674e564241674d416b4e424d5173770a435159445651514745774a56557a4165467730784f4441314d6a45784d4455774d5442614677307a4d7a41314d6a45784d4455774d5442614d484178496a41670a42674e5642414d4d47556c756447567349464e4857434251513073675547786864475a76636d306751304578476a415942674e5642416f4d45556c75644756730a49454e76636e4276636d4630615739754d5251774567594456515148444174545957353059534244624746795954454c4d416b474131554543417743513045780a437a414a42674e5642415954416c56544d466b77457759484b6f5a497a6a3043415159494b6f5a497a6a304441516344516741454e53422f377432316c58534f0a3243757a7078773734654a423732457944476757357258437478327456544c7136684b6b367a2b5569525a436e71523770734f766771466553786c6d546c4a6c0a65546d693257597a33714f42757a43427544416642674e5648534d4547444157674251695a517a575770303069664f44744a5653763141624f536347724442530a42674e5648523845537a424a4d45656752614244686b466f64485277637a6f764c324e6c636e52705a6d6c6a5958526c63793530636e567a6447566b633256790a646d6c6a5a584d75615735305a577775593239744c306c756447567355306459556d397664454e424c6d526c636a416442674e5648513445466751556c5739640a7a62306234656c4153636e553944504f4156634c336c517744675944565230504151482f42415144416745474d42494741315564457745422f7751494d4159420a4166384341514177436759494b6f5a497a6a30454177494452774177524149675873566b6930772b6936565947573355462f32327561586530594a446a3155650a6e412b546a44316169356343494359623153416d4435786b66545670766f34556f79695359787244574c6d5552344349394e4b7966504e2b0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a2d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949436a7a4343416a53674177494241674955496d554d316c71644e496e7a6737535655723951477a6b6e42717777436759494b6f5a497a6a3045417749770a614445614d4267474131554541777752535735305a5777675530645949464a766233516751304578476a415942674e5642416f4d45556c756447567349454e760a636e4276636d4630615739754d5251774567594456515148444174545957353059534244624746795954454c4d416b47413155454341774351304578437a414a0a42674e5642415954416c56544d423458445445344d4455794d5445774e4455784d466f58445451354d54497a4d54497a4e546b314f566f77614445614d4267470a4131554541777752535735305a5777675530645949464a766233516751304578476a415942674e5642416f4d45556c756447567349454e76636e4276636d46300a615739754d5251774567594456515148444174545957353059534244624746795954454c4d416b47413155454341774351304578437a414a42674e56424159540a416c56544d466b77457759484b6f5a497a6a3043415159494b6f5a497a6a3044415163445167414543366e45774d4449595a4f6a2f69505773437a61454b69370a314f694f534c52466857476a626e42564a66566e6b59347533496a6b4459594c304d784f346d717379596a6c42616c54565978465032734a424b357a6c4b4f420a757a43427544416642674e5648534d4547444157674251695a517a575770303069664f44744a5653763141624f5363477244425342674e5648523845537a424a0a4d45656752614244686b466f64485277637a6f764c324e6c636e52705a6d6c6a5958526c63793530636e567a6447566b63325679646d6c6a5a584d75615735300a5a577775593239744c306c756447567355306459556d397664454e424c6d526c636a416442674e564851344546675155496d554d316c71644e496e7a673753560a55723951477a6b6e4271777744675944565230504151482f42415144416745474d42494741315564457745422f7751494d4159424166384341514577436759490a4b6f5a497a6a3045417749445351417752674968414f572f35516b522b533943695344634e6f6f774c7550524c735747662f59693747535839344267775477670a41694541344a306c72486f4d732b586f356f2f7358364f39515778485241765a55474f6452513763767152586171493d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a00"
	devQuote      []byte
	devRawPrivKey = "fad9c8855b740a0b7ed4c221dbad0f33a83a49cad6b3fe8d5817ac83d38b6a19"
	devPrivKey    *ecdsa.PrivateKey
	devAddress    = "96216849c49358b10257cb55b28ea603c874b05e"
	devMrEnclave  = "7cb1afb4d3505b9028d9aec761be3541a703b072eee5800be2f98e844f1cebcc"
	devMrSigner   = "97f37974b1a9a1f64b2e50b820a79721078df06e1268a303bd8427100d587f44"
	devSignPem    = `-----BEGIN PRIVATE KEY-----
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
pK4/RBLeIlfuhtAY7Re86Q==
-----END PRIVATE KEY-----`
)

func init() {
	var err error
	devPrivKey, err = crypto.HexToECDSA(devRawPrivKey)
	if err != nil {
		panic(err)
	}
	devQuote, err = hex.DecodeString(devRawQuote)
	if err != nil {
		panic(err)
	}
}

type DevProvider struct{}

func NewSGXProvider(_ *flags.Arguments) Provider {
	return &DevProvider{}
}

func (p *DevProvider) LoadQuote(key common.Address) ([]byte, error) {
	return devQuote, nil
}

func (p *DevProvider) LoadPrivateKey() (*ecdsa.PrivateKey, error) {
	return devPrivKey, nil
}

func (p *DevProvider) SavePrivateKey(privKey *ecdsa.PrivateKey) error {
	// rewrite the private key with the mock one
	*privKey = *devPrivKey
	return nil
}

func (p *DevProvider) SaveBootstrap(b *BootstrapData) error {
	return nil
}
